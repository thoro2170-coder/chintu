from collections import Counter

class Library:
    def __init__(self):
        self.member_record = {}  # member_id : number of books borrowed
        self.book_record = {}    # book_title : number of times borrowed

    def add_member(self, member_id, borrowed_count):
        """Adds a member with their borrowed book count."""
        if member_id in self.member_record:
            raise ValueError(f"Member '{member_id}' already exists.")
        self.member_record[member_id] = borrowed_count

    def add_book(self, book_title, borrow_count):
        """Adds a book with its borrow count."""
        if book_title in self.book_record:
            raise ValueError(f"Book '{book_title}' already exists.")
        self.book_record[book_title] = borrow_count

    def compute_average_books_borrowed(self):
        """Computes average number of books borrowed per member."""
        total = sum(self.member_record.values())
        count = len(self.member_record)
        return total / count if count > 0 else 0

    def book_with_highest_and_lowest_borrowing(self):
        """Returns the book with the highest and lowest borrowing count."""
        if not self.book_record:
            return None, None
        highest = max(self.book_record.items(), key=lambda x: x[1])
        lowest = min(self.book_record.items(), key=lambda x: x[1])
        return highest, lowest

    def count_members_with_zero_borrowings(self):
        """Returns the number of members who borrowed zero books."""
        return sum(1 for count in self.member_record.values() if count == 0)

    def most_frequently_borrowed_book(self):
        """Returns the book(s) that were borrowed most frequently."""
        if not self.book_record:
            return None
        count_freq = Counter(self.book_record.values())
        mode_count = count_freq.most_common(1)[0][0]
        return sorted([book for book, count in self.book_record.items() if count == mode_count])


# ---------- Example usage ----------
if __name__ == "__main__":
    lib = Library()

    # Adding members (member_id: borrowed_count)
    lib.add_member("COSB01", 3)
    lib.add_member("COSB02", 0)
    lib.add_member("COSB03", 5)
    lib.add_member("COSB04", 0)

    # Adding books (book_title: borrow_count)
    lib.add_book("Python Basics", 10)
    lib.add_book("C++ Guide", 5)
    lib.add_book("Java Handbook", 10)
    lib.add_book("Data Science", 2)

    # Outputs
    print("Average books borrowed:", lib.compute_average_books_borrowed())
    highest, lowest = lib.book_with_highest_and_lowest_borrowing()
    print("Book with highest borrowing:", highest)
    print("Book with lowest borrowing:", lowest)
    print("Number of members who borrowed 0 books:", lib.count_members_with_zero_borrowings())
    print("Most frequently borrowed book(s):", lib.most_frequently_borrowed_book())
